<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AIéŸ³æ¨‚æŒ‡ä»¤ç”Ÿæˆå™¨ by superL (V24.1)</title>
    <style>
        /* --- åŸºç¤è¨­å®š --- */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f5f6fa; padding: 15px; padding-bottom: 600px; max-width: 1000px; margin: 0 auto; color: #2d3436; -webkit-text-size-adjust: 100%; }
        h2 { text-align: center; border-bottom: 3px solid #b2bec3; padding-bottom: 15px; margin-bottom: 20px; font-size: 1.5rem; }

        /* --- å€å¡Šæ¨£å¼ --- */
        .layer-box { background: white; padding: 15px; border-radius: 12px; margin-bottom: 15px; border-left: 6px solid #ccc; transition: all 0.3s ease; }
        .layer-recipe { border-left-color: #f1c40f; background: linear-gradient(to right, #fff, #fffbf0); border: 2px solid #f1c40f; }
        
        .layer-neural { border-left-color: #6c5ce7; background: #2d3436; color: #dfe6e9; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        
        .layer-1 { border-left-color: #0984e3; }
        .layer-2 { border-left-color: #d63031; }
        .layer-2b { border-left-color: #00b894; }
        .layer-4 { border-left-color: #e84393; }
        .layer-6 { border-left-color: #fd79a8; }
        .layer-5 { border-left-color: #e17055; }
        .layer-3 { border-left-color: #6c5ce7; }
        .layer-8 { border-left-color: #2d3436; }

        .title { font-weight: 800; font-size: 16px; margin-bottom: 4px; display: block; }
        .subtitle { font-size: 12px; color: #636e72; margin-bottom: 12px; display: block; font-style: italic; }
        .layer-neural .subtitle { color: #b2bec3; }
        .btn-group { display: flex; flex-wrap: wrap; gap: 8px; }

        /* --- æŒ‰éˆ• --- */
        button {
            padding: 8px 12px; border: 1px solid #dfe6e9; background: white; border-radius: 6px;
            cursor: pointer; font-size: 13px; font-weight: 600; color: #636e72; transition: all 0.1s;
            flex: 1 1 auto; text-align: center; min-width: 80px;
        }
        button:active { transform: scale(0.98); }
        .btn-recipe { border-color: #f1c40f; color: #d35400; background: #fff; box-shadow: 0 2px 4px rgba(241, 196, 15, 0.2); }
        .btn-recipe:hover { background: #f1c40f; color: white; }

        /* --- æ¿€æ´»ç‹€æ…‹ --- */
        .active { color: white !important; border-color: transparent !important; }
        
        .btn-struct.active { background: #0984e3; }
        .btn-region.active { background: #00b894; }
        .btn-inst.active { background: #6c5ce7; }
        .btn-emo.active { background: #e84393; }
        .btn-length.active { background: #e17055; }
        .btn-bpm.active { background: #d35400; }
        .btn-vox.active { background: #fd79a8; }
        .btn-mix.active { background: #2d3436; }
        .btn-neg.active { background: #eb4d4b; }
        .btn-main-genre.active { background: #d63031; transform: scale(1.02); box-shadow: 0 4px 8px rgba(214, 48, 49, 0.2); }

        /* --- ç¥ç¶“ç¶²çµ¡ UI --- */
        .neural-display { display: flex; flex-direction: column; gap: 15px; }
        .neural-breadcrumbs { display: flex; flex-wrap: wrap; gap: 5px; align-items: center; font-size: 13px; color: #a29bfe; margin-bottom: 5px; }
        .crumb { opacity: 0.7; cursor: pointer; text-decoration: underline; }
        .crumb:hover { opacity: 1; color: #fff; }
        .node-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .neural-node { background: rgba(255,255,255,0.05); border: 1px solid #6c5ce7; color: #dfe6e9; padding: 15px 10px; border-radius: 8px; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 0.2s; min-height: 60px; }
        .neural-node:hover { background: rgba(108, 92, 231, 0.2); border-color: #a29bfe; transform: translateY(-2px); }
        .node-icon { font-size: 20px; margin-bottom: 5px; }
        .node-label { font-weight: bold; font-size: 14px; }
        .node-desc { font-size: 11px; opacity: 0.7; margin-top: 3px; font-weight: normal; }

        /* --- å­é¢¨æ ¼æŒ‰éˆ• --- */
        .sub-genre-area { margin-top: 15px; padding-top: 15px; border-top: 1px dashed #eee; display: none; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
        .sub-btn { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 10px; border: 1px solid #fab1a0; background: #fff5f3; color: #d63031; border-radius: 8px; text-align: center; height: auto; }
        .sub-btn.active { background: #d63031; color: white; border-color: #b71540; }
        .sub-name { font-size: 14px; font-weight: bold; margin-bottom: 4px; }
        .sub-desc { font-size: 11px; opacity: 0.8; font-weight: normal; line-height: 1.3; }
        .sub-label { width: 100%; font-size: 12px; font-weight: bold; color: #b2bec3; margin: 10px 0 5px 0; border-bottom: 1px dashed #e1e1e1; padding-bottom: 2px; }

        /* --- ğŸ§ª åŒ–å­¸åæ‡‰å¯¦é©—å®¤ --- */
        .chemistry-lab { background: #2d3436; color: #fff; padding: 15px; border-radius: 12px; margin-bottom: 15px; border-left: 6px solid #a29bfe; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .lab-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; flex-wrap: wrap; gap:10px; }
        .lab-title { color: #a29bfe; font-weight: bold; font-size: 14px; display: flex; align-items: center; gap: 5px; }
        
        /* åœ–ä¾‹ (Legend) */
        .reaction-legend { display: flex; gap: 8px; font-size: 11px; }
        .legend-item { padding: 2px 6px; border-radius: 4px; border: 1px solid; }
        .legend-item.classic { border-color: #00b894; color: #55efc4; background: rgba(0, 184, 148, 0.1); }
        .legend-item.fusion { border-color: #a29bfe; color: #d1ccc0; background: rgba(162, 155, 254, 0.1); }
        .legend-item.warn { border-color: #ffeaa7; color: #ffeaa7; background: rgba(253, 203, 110, 0.1); }

        .lab-content { font-size: 13px; line-height: 1.6; min-height: 20px; }
        .reaction-item { margin-bottom: 6px; padding-left: 10px; border-left: 3px solid transparent; }
        .reaction-classic { border-left-color: #00b894; color: #55efc4; }
        .reaction-fusion { border-left-color: #a29bfe; color: #d1ccc0; }
        .reaction-conflict { border-left-color: #ffeaa7; color: #ffeaa7; font-weight: bold; }

        /* --- ğŸ›ï¸ é›™æ¨¡æ…‹ç›£æ§å®¤ (Monitor) --- */
        .monitor-area {
            background: #2d3436; border-radius: 12px 12px 0 0; padding: 15px;
            /* ä¿®æ­£ï¼šç›£æ§å®¤é«˜åº¦ç¢ºä¿ä¸è¢«æ“‹ä½ */
            position: fixed; bottom: 230px; left: 0; width: 100%; box-sizing: border-box;
            border-top: 4px solid #00b894; color: white; z-index: 9998;
            transition: all 0.3s ease; box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
        }
        .monitor-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .monitor-title { font-weight: bold; font-size: 14px; color: #00b894; }
        .monitor-toggle { background: rgba(255,255,255,0.1); border: 1px solid #636e72; color: #dfe6e9; padding: 4px 8px; border-radius: 15px; font-size: 11px; cursor: pointer; }
        
        /* æ¨¡å¼ A: èšç„¦å„€è¡¨æ¿ */
        .focus-bar-container { width: 100%; height: 10px; background: #636e72; border-radius: 5px; position: relative; overflow: hidden; margin-bottom: 5px; }
        .focus-bar-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #81ecec, #00b894); transition: width 0.5s ease; }
        .focus-status { display: flex; justify-content: space-between; font-size: 11px; color: #b2bec3; margin-bottom: 5px; }
        .ghost-chips { display: flex; gap: 5px; flex-wrap: wrap; }
        .ghost-chip { padding: 2px 6px; border: 1px dashed #636e72; color: #636e72; border-radius: 4px; font-size: 10px; cursor: pointer; transition: all 0.2s; }
        .ghost-chip:hover { border-color: #00b894; color: #00b894; }

        /* æ¨¡å¼ B: é›·é”åœ– */
        .radar-container { display: none; justify-content: center; align-items: center; height: 120px; }
        svg { overflow: visible; }
        .radar-axis { stroke: #636e72; stroke-width: 1; }
        .radar-shape { fill: rgba(0, 184, 148, 0.4); stroke: #00b894; stroke-width: 2; transition: all 0.5s ease; }

        /* --- çµæœå€ --- */
        .result-area { position: fixed; bottom: 0; left: 0; width: 100%; background-color: #2d3436; padding: 15px; border-top: 1px solid #444; box-shadow: 0 -5px 20px rgba(0,0,0,0.3); z-index: 9999; box-sizing: border-box; }
        .custom-input { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 6px; border: none; background: #dfe6e9; color: #2d3436; font-size: 14px; box-sizing: border-box; }
        textarea { width: 100%; height: 60px; background: #353b48; color: #55efc4; border: 1px solid #555; padding: 10px; border-radius: 8px; font-size: 14px; font-family: monospace; resize: none; box-sizing: border-box; }
        .char-counter { text-align: right; font-size: 12px; font-weight: bold; margin-top: 5px; font-family: monospace; }
        .count-safe { color: #00b894; } .count-warning { color: #fdcb6e; } .count-danger { color: #ff7675; }
        
        /* éƒµä»¶ç™¼é€å€ */
        .email-section { display: flex; gap: 10px; margin-top: 10px; align-items: center; }
        .email-input { flex: 1; padding: 10px; border-radius: 6px; border: 1px solid #636e72; background: #2d3436; color: white; font-size: 13px; }
        .send-btn { flex: 0.6; padding: 10px; background: #0984e3; color: white; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; }
        .copy-btn { flex: 1; padding: 10px; background: #00b894; color: white; font-weight: bold; font-size: 14px; border: none; border-radius: 6px; cursor: pointer; }
    </style>
</head>
<body>

    <h2>ğŸ» AIéŸ³æ¨‚æŒ‡ä»¤ç”Ÿæˆå™¨ by superL (V24.1)</h2>

    <div class="layer-box layer-recipe">
        <span class="title">ğŸ† Layer 0. é»ƒé‡‘é…æ–¹</span>
        <span class="subtitle">ã€Œå¤§å¸«çš„ç§æˆ¿èœå–®ï¼Œä¸€éµæ³¨å…¥éˆé­‚ã€‚ã€</span>
        <div class="btn-group">
            <button class="btn-recipe" onclick="applyPreset('intimate')">1. æƒ…æ„Ÿç¨å¥</button>
            <button class="btn-recipe" onclick="applyPreset('epic')">2. å²è©©å‹•ä½œ</button>
            <button class="btn-recipe" onclick="applyPreset('cyberpunk')">3. è³½åšæœªä¾†</button>
            <button class="btn-recipe" onclick="applyPreset('ghibli')">4. å‰åœåŠ›é¢¨</button>
            <button class="btn-recipe" onclick="applyPreset('phonk')">5. æµé‡ Phonk</button>
            <button class="btn-recipe" onclick="applyPreset('lofi')">6. æ·±å¤œ Lofi</button>
            <button class="btn-recipe" onclick="applyPreset('kpop')">7. éŸ“æµ K-Pop</button>
            <button class="btn-recipe" onclick="applyPreset('latin')">8. ç†±æƒ…æ‹‰ä¸</button>
        </div>
    </div>

    <div class="layer-box layer-neural">
        <span class="title">ğŸ§  Layer 1. å‰µä½œç›®çš„ç¥ç¶“ç¶²çµ¡ (Neural Nav)</span>
        <span class="subtitle">ã€Œç›®æ¨™å°èˆª (Destination) â€” è·Ÿéš¨ç¯€é»ï¼ŒAI å°‡è‡ªå‹•ç‚ºæ‚¨é…ç½®æœ€ä½³åƒæ•¸ã€‚ã€</span>
        <div class="neural-display">
            <div class="neural-breadcrumbs" id="neuralBreadcrumbs"><span>è«‹é¸æ“‡èµ·é»...</span></div>
            <div class="node-container" id="neuralNodes"></div>
            <div id="neuralStatus" style="font-size:12px; color:#55efc4; margin-top:5px; display:none;">ğŸ¤– AI å·²è‡ªå‹•é…ç½®ç›¸é—œåƒæ•¸ï¼</div>
        </div>
    </div>

    <div class="layer-box layer-1">
        <span class="title">ğŸ“ Layer 2. æ­Œæ›²çµæ§‹éª¨æ¶ (å–®é¸)</span>
        <span class="subtitle">ã€Œæ•…äº‹çš„éª¨æ¶ (Skeleton) â€” æ±ºå®šé€™é¦–æ­Œçš„èµ·æ‰¿è½‰åˆã€‚ã€</span>
        <div class="btn-group">
            <button class="btn-struct" data-val="[Intro], [Verse 1], [Pre-Chorus], [Chorus], [Verse 2], [Chorus], [Bridge], [Outro]" onclick="selectSingle(this, 'struct')">ğŸ“» å»£æ’­é‡‘æ›² (å®Œæ•´)</button>
            <button class="btn-struct" data-val="[Catchy Hook], [Fast Build Up], [Drop], [High Energy Chorus], [Sudden End]" onclick="selectSingle(this, 'struct')">ğŸ“± ç—…æ¯’çˆ†ç™¼ (çŸ­ç‰ˆ)</button>
            <button class="btn-struct" data-val="[Atmospheric Intro], [Main Theme], [Slow Build Up], [Emotional Climax], [Fade Out]" onclick="selectSingle(this, 'struct')">ğŸ¬ èµ·æ‰¿è½‰åˆ (æ•˜äº‹)</button>
            <button class="btn-struct" data-val="[Soft Intro], [Steady Rhythm], [Linear Progression], [No Sudden Changes], [Seamless Loop]" onclick="selectSingle(this, 'struct')">â˜•ï¸ å¹³ç©©é‹ªåº• (æ°›åœ)</button>
            <button class="btn-struct" data-val="[Grand Overture], [Soloist Entry], [Complex Development], [Cadenza], [Grand Finale]" onclick="selectSingle(this, 'struct')">ğŸ» è¤‡é›œæ¨‚ç«  (å¤å…¸)</button>
        </div>
    </div>

    <div class="layer-box layer-2" id="layer-style">
        <span class="title">ğŸ¹ Layer 3. éŸ³æ¨‚é¢¨æ ¼æµæ´¾</span>
        <span class="subtitle">ã€Œé¢¨æ ¼åŸ¹é¤Šçš¿ (The Context) â€” ä¸€åˆ‡åŒ–å­¸åæ‡‰çš„åŸºåº•ã€‚ã€</span>
        <div class="btn-group" id="mainGenreContainer">
            <button class="btn-main-genre" onclick="renderSubGenres('pop_electronic', this)">ğŸ¹ æµè¡Œé›»å­</button>
            <button class="btn-main-genre" onclick="renderSubGenres('hiphop_rb', this)">ğŸ¤ å˜»å“ˆç¯€å¥</button>
            <button class="btn-main-genre" onclick="renderSubGenres('rock_alt', this)">ğŸ¸ æ–æ»¾å¦é¡</button>
            <button class="btn-main-genre" onclick="renderSubGenres('folk_acoustic', this)">ğŸŒ² æ°‘è¬ é„‰æ‘</button>
            <button class="btn-main-genre" onclick="renderSubGenres('jazz_blues', this)">ğŸ· çˆµå£«è—èª¿</button>
            <button class="btn-main-genre" onclick="renderSubGenres('classical_cinematic', this)">ğŸ» å¤å…¸å²è©©</button>
            <button class="btn-main-genre" onclick="renderSubGenres('latin_world', this)">ğŸï¸ æ‹‰ä¸ä¸–ç•Œ</button>
            <button class="btn-main-genre" onclick="renderSubGenres('ambient_lofi', this)">â˜ï¸ æ°›åœä½å‚³çœŸ</button>
        </div>
        <div id="subGenreDisplay" class="sub-genre-area"></div>
    </div>

    <div class="layer-box layer-2b">
        <span class="title">ğŸŒ Layer 4. åœ°å€æµé‡å¯†ç¢¼</span>
        <span class="subtitle">ã€Œæ–‡åŒ–çš„é¦™æ–™ (Spice) â€” è®“éŸ³æ¨‚å¸¶æœ‰ç‰¹å®šåœ°å€çš„è‰²å½©ã€‚ã€</span>
        <div class="btn-group">
            <button class="btn-region" data-val="K-Pop, Catchy Hook, Korean Lyrics" onclick="toggleTag(this)">ğŸ‡°ğŸ‡· éŸ“æµ K-Pop</button>
            <button class="btn-region" data-val="J-Pop, Anime Opening, Japanese Lyrics" onclick="toggleTag(this)">ğŸ‡¯ğŸ‡µ æ—¥ç³»äºŒæ¬¡å…ƒ</button>
            <button class="btn-region" data-val="US Pop, Billboard Chart Style, Atlanta Trap" onclick="toggleTag(this)">ğŸ‡ºğŸ‡¸ ç¾å¼æ’è¡Œ</button>
            <button class="btn-region" data-val="Reggaeton, Latin Pop, Spanish Lyrics" onclick="toggleTag(this)">ğŸ‡§ğŸ‡· æ‹‰ä¸ç†±æµª</button>
            <button class="btn-region" data-val="Afrobeats, Log Drum, Amapiano" onclick="toggleTag(this)">ğŸŒ éæ´²å¾‹å‹•</button>
            <button class="btn-region" data-val="C-Pop, Mandopop, Sentimental Ballad" onclick="toggleTag(this)">ğŸ‡¨ğŸ‡³ è¯èªæµè¡Œ</button>
            <button class="btn-region" data-val="Bollywood, Punjabi, Indian Percussion" onclick="toggleTag(this)">ğŸ‡®ğŸ‡³ å¯¶èŠå¡¢</button>
            <button class="btn-region" data-val="Drift Phonk, Cowbell, Distorted Bass" onclick="toggleTag(this)">ğŸŒ ç¶²è·¯ Phonk</button>
        </div>
    </div>

    <div class="layer-box layer-4" id="layer-mood">
        <span class="title">â¤ï¸ Layer 5. æƒ…æ„Ÿèˆ‡å¿ƒæƒ…</span>
        <span class="subtitle">ã€Œæƒ…æ„Ÿèª¿è‰²ç›¤ (Palette) â€” ç‚ºéŸ³æ¨‚æŸ“ä¸Šæƒ…ç·’çš„æº«åº¦ã€‚ã€</span>
        <div class="btn-group">
            <button class="btn-emo" data-val="Dopamine Rush, Euphoric, Super Happy, Energetic, Uplifting" onclick="toggleTag(this)">â˜€ï¸ Dopamine Rush (å¿«æ¨‚)</button>
            <button class="btn-emo" data-val="3AM Thoughts, Melancholic, Lonely, Sad, Heartbroken" onclick="toggleTag(this)">ğŸ’§ 3AM Thoughts (æ·±å¤œemo)</button>
            <button class="btn-emo" data-val="Main Character Energy, Epic, Triumphant, Powerful, Heroic" onclick="toggleTag(this)">âš”ï¸ Main Character (ç†±è¡€)</button>
            <button class="btn-emo" data-val="Core Memory, Nostalgic, Warm, Bittersweet, Sentimental" onclick="toggleTag(this)">ğŸ‚ Core Memory (æ‡·èˆŠ)</button>
            <button class="btn-emo" data-val="Villain Arc, Dark Tension, Suspenseful, Dangerous, Menacing" onclick="toggleTag(this)">ğŸ”¥ Villain Arc (æš—é»‘)</button>
            <button class="btn-emo" data-val="Dreamscape, Ethereal, Dreamy, Magical, Surreal" onclick="toggleTag(this)">âœ¨ POV: Dreamscape (å¤¢å¹»)</button>
        </div>
    </div>

    <div class="layer-box layer-6" id="layer-vox">
        <span class="title">ğŸ¤ Layer 6. äººè²èˆ‡ä¸»è§’</span>
        <span class="subtitle">ã€ŒåŠ‡æœ¬çš„ä¸»è§’ (Protagonist) â€” èª°ä¾†æ¼”ç¹¹é€™æ®µæ•…äº‹ï¼Ÿã€</span>
        <div class="sub-label">ğŸ¹ æµè¡Œèˆ‡ç¾ä»£</div>
        <div class="btn-group">
            <button class="btn-vox" data-val="Female Whisper Pop, Breathy Vocals, Intimate, ASMR" onclick="toggleTag(this)">[å¥³] æ°£è²è‡¥å®¤</button>
            <button class="btn-vox" data-val="Soft Male Vocals, Gentle, Boy Band Style, Emotional" onclick="toggleTag(this)">[ç”·] æº«æŸ”å°‘å¹´</button>
            <button class="btn-vox" data-val="J-Pop Idol Vocals, High-pitched, Kawaii, Anime OP" onclick="toggleTag(this)">[å¥³] äºŒæ¬¡å…ƒ/åŠ é€Ÿ</button>
            <button class="btn-vox" data-val="Male Vocals, Heavy Autotune, Robotic, Melodic Rap" onclick="toggleTag(this)">[ç”·] æµè¡Œé›»éŸ³</button>
        </div>
        <div class="sub-label">ğŸ¸ æ–æ»¾èˆ‡æ‡·èˆŠ</div>
        <div class="btn-group">
            <button class="btn-vox" data-val="Powerhouse Female Vocals, Belting, High Notes, Passionate" onclick="toggleTag(this)">[å¥³] éµè‚ºé«˜éŸ³</button>
            <button class="btn-vox" data-val="Raspy Male Vocals, Gritty, Gravelly Voice, Rough" onclick="toggleTag(this)">[ç”·] ç²—ç·ç…™å—“</button>
            <button class="btn-vox" data-val="70s Soul Diva, Warmth, Vintage Microphone" onclick="toggleTag(this)">[å¥³] 70s éˆé­‚</button>
            <button class="btn-vox" data-val="70s Soft Rocker, Folk Rock Style" onclick="toggleTag(this)">[ç”·] 70s è»Ÿæ–æ»¾</button>
        </div>
        <div class="sub-label">ğŸ¤ ç¯€å¥èˆ‡å˜»å“ˆ</div>
        <div class="btn-group">
            <button class="btn-vox" data-val="Female Soul Vocals, R&B Runs, Melismatic, Expressive" onclick="toggleTag(this)">[å¥³] éˆé­‚è½‰éŸ³</button>
            <button class="btn-vox" data-val="Smooth R&B Male Vocals, Falsetto, Sexy" onclick="toggleTag(this)">[ç”·] æ·±æƒ… R&B</button>
            <button class="btn-vox" data-val="Female Rap, Sassy, Fast Flow, Confident" onclick="toggleTag(this)">[å¥³] å€‹æ€§é¥’èˆŒ</button>
            <button class="btn-vox" data-val="Male Melodic Rap, Trap Flow, Mumble Rap" onclick="toggleTag(this)">[ç”·] æ—‹å¾‹é¥’èˆŒ</button>
        </div>
        <div class="sub-label">ğŸ›ï¸ å¤å…¸èˆ‡ç¾è²</div>
        <div class="btn-group">
            <button class="btn-vox" data-val="Operatic Soprano, Classical Aria, Legato, Vibrato" onclick="toggleTag(this)">[å¥³] æ­ŒåŠ‡å¥³é«˜éŸ³</button>
            <button class="btn-vox" data-val="Operatic Tenor, Powerful, Classical Style" onclick="toggleTag(this)">[ç”·] æ­ŒåŠ‡ç”·é«˜éŸ³</button>
        </div>
    </div>

    <div class="layer-box layer-5" id="layer-bpm">
        <span class="title">ğŸï¸ Layer 7. æ™‚é–“èˆ‡é€Ÿåº¦</span>
        <span class="subtitle">ã€Œå¿ƒè·³èˆ‡è„ˆæ (The Pulse) â€” æŒæ§æ™‚é–“æµå‹•çš„å¿«æ…¢ã€‚ã€</span>
        <div class="sub-label">â±ï¸ é•·åº¦ (å–®é¸)</div>
        <div class="btn-group">
            <button class="btn-length" data-val="[15 Seconds], [Quick Fade Out]" onclick="selectSingle(this, 'length')">15ç§’ (é™å‹•)</button>
            <button class="btn-length" data-val="[30 Seconds], [Hard Stop]" onclick="selectSingle(this, 'length')">30ç§’ (å»£å‘Š)</button>
            <button class="btn-length" data-val="[3 Minutes], [Radio Edit]" onclick="selectSingle(this, 'length')">3åˆ† (å®Œæ•´)</button>
            <button class="btn-length" data-val="[Seamless Loop]" onclick="selectSingle(this, 'length')">ç„¡é™å¾ªç’° (Loop)</button>
        </div>
        <div class="sub-label">ğŸï¸ é€Ÿåº¦ (å–®é¸)</div>
        <div class="btn-group">
            <button class="btn-bpm" data-val="65 BPM, Largo, Slow Tempo" onclick="selectSingle(this, 'bpm')">65 (æ…¢æ¿)</button>
            <button class="btn-bpm" data-val="90 BPM, Groove, Mid Tempo" onclick="selectSingle(this, 'bpm')">90 (å˜»å“ˆ/Vlog)</button>
            <button class="btn-bpm" data-val="120 BPM, Pop Tempo" onclick="selectSingle(this, 'bpm')">120 (æµè¡Œ)</button>
            <button class="btn-bpm" data-val="140 BPM, High Energy, Fast Tempo" onclick="selectSingle(this, 'bpm')">140 (é‹å‹•)</button>
            <button class="btn-bpm" data-val="175 BPM, Very Fast, Drum and Bass Tempo" onclick="selectSingle(this, 'bpm')">175 (Phonk)</button>
        </div>
    </div>

    <div class="layer-box layer-3" id="layer-inst">
        <span class="title">ğŸ» Layer 8. å™¨æ¨‚ç´°ç¯€ (V24 Pro)</span>
        <span class="subtitle">ã€Œé—œéµå‚¬åŒ–åŠ‘ (The Catalyst) â€” æ”¹è®Šè½æ„Ÿçš„æ±ºå®šæ€§è®Šæ•¸ã€‚ã€</span>
        
        <div class="chemistry-lab">
            <div class="lab-header">
                <span class="lab-title">ğŸ§ª éŸ³æ¨‚åŒ–å­¸åæ‡‰å®¤</span>
                <div class="reaction-legend">
                    <span class="legend-item classic">âœ… ç¶“å…¸</span>
                    <span class="legend-item fusion">ğŸ§ª èåˆ</span>
                    <span class="legend-item warn">âš ï¸ è¡çª</span>
                </div>
            </div>
            <div id="chemistryContent" class="lab-content">
                è«‹å…ˆé¸æ“‡ <b>Layer 3</b> é¢¨æ ¼èˆ‡ <b>Layer 5/8</b> å…ƒç´ ï¼Œç³»çµ±å°‡ç‚ºæ‚¨åˆ†æåŒ–å­¸åæ‡‰...
            </div>
        </div>

        <div class="sub-label">ğŸ· ç®¡æ¨‚èˆ‡éŠ…ç®¡</div>
        <div class="btn-group">
            <button class="btn-inst" data-val="Saxophone Solo, Smoky Tone, Jazz Lead" onclick="toggleTag(this)">è–©å…‹æ–¯é¢¨</button>
            <button class="btn-inst" data-val="Brass Section, Punchy Horns, Trumpet & Trombone" onclick="toggleTag(this)">éŠ…ç®¡æ¨‚åœ˜</button>
            <button class="btn-inst" data-val="Muted Trumpet Solo, Noir Jazz, Miles Davis Style" onclick="toggleTag(this)">å¼±éŸ³å°è™Ÿ</button>
            <button class="btn-inst" data-val="Flute Solo, Ethereal, Folk Instrument" onclick="toggleTag(this)">é•·ç¬›</button>
            <button class="btn-inst" data-val="Harmonica Solo, Blues Harp, Folk Style" onclick="toggleTag(this)">å£ç´</button>
        </div>

        <div class="sub-label">ğŸ» å¼¦æ¨‚èˆ‡å‰ä»–</div>
        <div class="btn-group">
            <button class="btn-inst" data-val="Solo Cello, Deep, Emotional String" onclick="toggleTag(this)">å¤§æç´ç¨å¥</button>
            <button class="btn-inst" data-val="String Section, Orchestral Strings, Cinematic" onclick="toggleTag(this)">å¼¦æ¨‚ç¾¤</button>
            <button class="btn-inst" data-val="Electric Guitar, Clean Tone, Chorus Effect" onclick="toggleTag(this)">é›»å‰ä»–</button>
            <button class="btn-inst" data-val="Acoustic Guitar, Fingerpicking, Unplugged" onclick="toggleTag(this)">æœ¨å‰ä»–</button>
            <button class="btn-inst" data-val="Slap Bass, Funk Groove, Thumping Bass" onclick="toggleTag(this)">æ“Šå‹¾è²æ–¯</button>
        </div>

        <div class="sub-label">ğŸ¹ éµç›¤èˆ‡åˆæˆå™¨</div>
        <div class="btn-group">
            <button class="btn-inst" data-val="Grand Piano, Steinway, Classical Tone" onclick="toggleTag(this)">å¹³å°é‹¼ç´</button>
            <button class="btn-inst" data-val="Rhodes Electric Piano, Warm, Neo-Soul Keys" onclick="toggleTag(this)">Rhodes é›»é‹¼ç´</button>
            <button class="btn-inst" data-val="Synthesizer Lead, Sawtooth Wave, Futurtistic" onclick="toggleTag(this)">åˆæˆå™¨</button>
            <button class="btn-inst" data-val="Pipe Organ, Church Organ, Gothic, Holy" onclick="toggleTag(this)">ç®¡é¢¨ç´</button>
        </div>
        
        <div class="sub-label">ğŸ¥ ç¯€å¥èˆ‡ç‰¹æ•ˆ</div>
        <div class="btn-group">
            <button class="btn-inst" data-val="Live Drum Kit, Acoustic Drums, Dynamic" onclick="toggleTag(this)">çˆµå£«é¼“</button>
            <button class="btn-inst" data-val="Distorted 808 Bass, Sub-bass, Earthshaking" onclick="toggleTag(this)">808é‡ä½éŸ³</button>
            <button class="btn-inst" data-val="Trap Drum Machine, Hi-hat Rolls, 808s" onclick="toggleTag(this)">é™·é˜±é¼“æ©Ÿ</button>
            <button class="btn-inst" data-val="Orchestral Percussion, Timpani, War Drums" onclick="toggleTag(this)">å²è©©æ‰“æ“Šæ¨‚</button>
            <button class="btn-inst" data-val="World Percussion, Congas, Bongos, Tribal" onclick="toggleTag(this)">ä¸–ç•Œæ‰“æ“Šæ¨‚</button>
            <button class="btn-inst" data-val="Vinyl Crackle, Lo-fi Hiss, Background Noise" onclick="toggleTag(this)">é»‘è† åº•å™ª</button>
            <button class="btn-inst" data-val="Phonk Cowbell, Drift Phonk Style" onclick="toggleTag(this)">Phonkç‰›éˆ´</button>
        </div>
    </div>

    <div class="layer-box layer-8" id="layer-mix">
        <span class="title">ğŸ›ï¸ Layer 9. æ··éŸ³æ¿¾é¡èˆ‡æ’é™¤</span>
        <span class="subtitle">ã€Œæ™‚ç©ºæ¿¾é¡ (The Lens) â€” æ±ºå®šè²éŸ³çš„å¹´ä»£èˆ‡é¡†ç²’æ„Ÿã€‚ã€</span>
        <div class="sub-label">ğŸ›ï¸ é¢¨æ ¼æ¿¾é¡</div>
        <div class="btn-group">
            <button class="btn-mix" data-val="Vintage Recording, Vinyl Crackle, Hiss, Warm Analog" onclick="toggleTag(this)">ğŸ“¼ å¾©å¤é»‘è† </button>
            <button class="btn-mix" data-val="Muffled Sound, Low Fidelity, Underwater Effect" onclick="toggleTag(this)">ğŸ“» æ‚¶éŸ³/Lo-fi</button>
            <button class="btn-mix" data-val="Bitcrushed, Industrial Distortion, Aggressive Mix" onclick="toggleTag(this)">âš¡ ç ´éŸ³/å¤±çœŸ</button>
            <button class="btn-mix" data-val="High Fidelity, Clear Production, Studio Quality" onclick="toggleTag(this)">âœ¨ é«˜æ¸…/ç¾ä»£</button>
            <button class="btn-mix" data-val="Live Concert Recording, Crowd Noise, Stadium Reverb" onclick="toggleTag(this)">ğŸ¤ ç¾å ´</button>
            <button class="btn-mix" data-val="Dry Sound, Close-mic, No Reverb, Intimate Studio" onclick="toggleTag(this)">ğŸ™ï¸ éŒ„éŸ³å®¤ä¹¾è²</button>
        </div>
        <div class="sub-label" style="color:#eb4d4b;">â›” å¼·åŠ›æ’é™¤</div>
        <div class="btn-group">
            <button class="btn-neg" data-val="[Instrumental], [No Vocals]" onclick="toggleTag(this)">ğŸš« ç´”éŸ³æ¨‚</button>
            <button class="btn-neg" data-val="[No Drums], [No Percussion]" onclick="toggleTag(this)">ğŸš« ç„¡ç¯€å¥</button>
            <button class="btn-neg" data-val="[Acoustic], [No Electronic]" onclick="toggleTag(this)">ğŸš« ç´”åŸè²</button>
            <button class="btn-neg" data-val="[No Rap]" onclick="toggleTag(this)">ğŸš« ç„¡é¥’èˆŒ</button>
            <button class="btn-neg" data-val="[Clean], [No Noise]" onclick="toggleTag(this)">ğŸš« ç„¡é›œè¨Š</button>
            <button class="btn-neg" data-val="[Simple], [Minimalist]" onclick="toggleTag(this)">ğŸš« æ¥µç°¡åŒ–</button>
        </div>
    </div>
    
    <div class="monitor-area" id="monitorArea">
        <div class="monitor-header">
            <span class="monitor-title">ğŸ›ï¸ superL é›™æ¨¡æ…‹ç›£æ§å®¤</span>
            <button class="monitor-toggle" onclick="toggleMonitorMode()">ğŸ‘ï¸ åˆ‡æ›è¦–åœ– (Mode)</button>
        </div>
        
        <div id="focusMode">
            <div class="focus-status">
                <span id="focusLabel">ğŸ² AI éš¨æ©Ÿç”Ÿæˆ</span>
                <span id="focusPercent">15%</span>
            </div>
            <div class="focus-bar-container">
                <div class="focus-bar-fill" id="focusBar"></div>
            </div>
            <div class="ghost-chips" id="ghostChips">
                </div>
        </div>

        <div id="radarMode" class="radar-container">
            <svg width="120" height="120" viewBox="0 0 100 100">
                <polygon points="50,10 85,30 85,70 50,90 15,70 15,30" fill="none" stroke="#444" stroke-width="0.5"/>
                <polygon points="50,30 67,40 67,60 50,70 33,60 33,40" fill="none" stroke="#444" stroke-width="0.5"/>
                <line x1="50" y1="50" x2="50" y2="10" class="radar-axis"/>
                <line x1="50" y1="50" x2="85" y2="30" class="radar-axis"/>
                <line x1="50" y1="50" x2="85" y2="70" class="radar-axis"/>
                <line x1="50" y1="50" x2="50" y2="90" class="radar-axis"/>
                <line x1="50" y1="50" x2="15" y2="70" class="radar-axis"/>
                <line x1="50" y1="50" x2="15" y2="30" class="radar-axis"/>
                <polygon id="radarShape" points="50,50 50,50 50,50 50,50 50,50 50,50" class="radar-shape"/>
            </svg>
            <div style="margin-left:15px; font-size:10px; color:#b2bec3; display:flex; flex-direction:column; gap:2px;">
                <div>â¬†ï¸ é¢¨æ ¼ (Style)</div>
                <div>â†—ï¸ æƒ…æ„Ÿ (Mood)</div>
                <div>â†˜ï¸ å¾‹å‹• (Rhythm)</div>
                <div>â¬‡ï¸ æ··éŸ³ (Mix)</div>
                <div>â†™ï¸ äººè² (Vox)</div>
                <div>â†–ï¸ æ¨‚å™¨ (Inst)</div>
            </div>
        </div>
    </div>

    <div class="tips-container" style="margin-bottom:180px;">
        <details>
            <summary>âœ¨ é»æ­¤æŸ¥çœ‹ï¼š5 å€‹è®“ AI æ›´è½è©±çš„é»ƒé‡‘æ³•å‰‡</summary>
            <div class="tips-content">
                <div class="tip-item"><strong>1. çµ¦ç•«é¢</strong><span class="tip-ex">ä¾‹: Rain sounds, Lonely street</span></div>
                <div class="tip-item"><strong>2. å®šä¸»é¡Œ</strong><span class="tip-ex">ä¾‹: About a broken robot</span></div>
                <div class="tip-item"><strong>3. é¸ä¸»è§’</strong><span class="tip-ex">ä¾‹: Saxophone Solo</span></div>
                <div class="tip-item"><strong>4. å½¢å®¹è²éŸ³</strong><span class="tip-ex">ä¾‹: Raspy voice, Breathy</span></div>
                <div class="tip-item"><strong>5. ç‰¹æ®Šæ“ä½œ</strong><span class="tip-ex">ä¾‹: [Silence], [Spoken Word]</span></div>
            </div>
        </details>
    </div>

    <div class="result-area">
        <div style="margin-bottom:8px;">
            <input type="text" id="customInput" class="custom-input" placeholder="âœ¨ è£œå……æŒ‡ä»¤... (é»æ“Šä¸Šæ–¹ç´«è‰²é¸å–®æŸ¥çœ‹æŠ€å·§)" oninput="render()">
        </div>
        <div style="display:flex; justify-content:space-between; color:#f1c40f; font-weight:bold; margin-bottom:5px; font-size:14px;">
            <span>ğŸ“œ æœ€çµ‚ç”ŸæˆæŒ‡ä»¤ï¼š</span>
            <span style="cursor:pointer; text-decoration: underline;" onclick="resetAll()">[ é‡ç½®å…¨éƒ¨ ]</span>
        </div>
        <textarea id="output" placeholder="è«‹é»é¸ä¸Šæ–¹æŒ‰éˆ•..." readonly></textarea>
        <div id="charCount" class="char-counter count-safe">0 / 500</div>
        
        <div class="email-section">
            <button class="copy-btn" onclick="copyText()">ğŸ“‹ è¤‡è£½æŒ‡ä»¤ (Copy)</button>
            <input type="email" id="userEmail" class="email-input" placeholder="æ‚¨çš„ Email (é¸å¡«)">
            <button class="send-btn" onclick="sendToDev()">ğŸ“§ å‚³é€çµ¦é–‹ç™¼è€…</button>
        </div>
    </div>
    
    <script>
        // --- å…¨åŸŸè®Šæ•¸ ---
        let struct = "";
        let lengthTag = ""; 
        let bpmTag = "";    
        let tags = [];      
        let currentSubGenreCode = ""; 
        let currentSubGenrePrompt = ""; 
        let monitorMode = 'focus'; // 'focus' or 'radar'

        // --- æ ¸å¿ƒè³‡æ–™åº« (Knowledge Base) ---
        const genreData = {
            "pop_electronic": {
                name: "ğŸ¹ æµè¡Œèˆ‡é›»å­",
                subs: [
                    { name: "City Pop", desc: "80sæ—¥æœ¬éƒ½æœƒé¢¨", prompt: "City Pop, 80s Japanese Pop, Plastic Love Vibe, Neon City", code: "CityPop" },
                    { name: "Synthwave", desc: "ç§‘å¹»è³½åšé¢¨", prompt: "Synthwave, Cyberpunk, Blade Runner Vibe, Futuristic, Retrowave", code: "Synthwave" },
                    { name: "Deep House", desc: "æ™‚å°šèµ°ç§€", prompt: "Deep House, Minimal, Fashion Runway Vibe, Soulful Vocals", code: "DeepHouse" },
                    { name: "Dream Pop", desc: "å¤¢å¹»æ¨¡ç³Š", prompt: "Dream Pop, Shoegaze, Reverb-heavy Vocals, Fuzzy Guitar, Ethereal", code: "DreamPop" },
                    { name: "Modern Pop", desc: "ç¾ä»£ä¸»æµ", prompt: "Contemporary Pop, Top 40, Catchy, Polished, High Production", code: "ModernPop" },
                    { name: "Hyperpop", desc: "èª‡å¼µå¤±çœŸ", prompt: "Hyperpop, Glitch, Distorted Bass, High-pitched Vocals, Experimental", code: "Hyperpop" }
                ]
            },
            "hiphop_rb": {
                name: "ğŸ¤ å˜»å“ˆç¯€å¥",
                subs: [
                    { name: "Trap", desc: "é‡ä½éŸ³ç‚¸è£‚", prompt: "Trap Music, Heavy 808 Bass, Hi-hat rolls, Auto-tune, Club Banger", code: "Trap" },
                    { name: "Lofi Hip Hop", desc: "è®€æ›¸æ”¾é¬†", prompt: "Lofi Hip Hop, Chillhop, Vinyl Crackle, Mellow Piano, Study Beats", code: "Lofi" },
                    { name: "Neo-Soul", desc: "æ…µæ‡¶éˆé­‚", prompt: "Neo-Soul, Groovy Bass, Electric Piano, Laid back, Jazzy Chords", code: "NeoSoul" },
                    { name: "Old School", desc: "90å¹´ä»£ç¶“å…¸", prompt: "90s Boom Bap, Golden Age Hip Hop, Sampled Drum Break, East Coast Vibe", code: "OldSchool" },
                    { name: "Drill", desc: "é»‘æš—æš´åŠ›", prompt: "UK Drill, Sliding 808 Bass, Dark Melody, Aggressive, Dark Energy", code: "Drill" }
                ]
            },
            "rock_alt": { name: "ğŸ¸ æ–æ»¾å¦é¡", subs: [ { name: "Pop Punk", desc: "æ ¡åœ’é’æ˜¥", prompt: "Pop Punk, High Energy, Teenage Angst, Fast Tempo", code: "PopPunk" }, { name: "Indie Rock", desc: "æ–‡é’ç¨ç«‹", prompt: "Indie Rock, Raw, Garage Band, Alternative", code: "IndieRock" }, { name: "Shoegaze", desc: "å·¨å¤§éŸ³ç‰†", prompt: "Shoegaze, Wall of Sound, Ethereal, Distorted, Dreamy", code: "Shoegaze" }, { name: "Post-Rock", desc: "æƒ…ç·’çˆ†ç™¼", prompt: "Post-Rock, Cinematic Build Up, Emotional Crescendo, No Vocals", code: "PostRock" }, { name: "Math Rock", desc: "è¤‡é›œé»å¼¦", prompt: "Math Rock, Complex Time Signatures, Tapping Guitar, Clean Tone", code: "MathRock" } ] },
            "folk_acoustic": { name: "ğŸŒ² æ°‘è¬ é„‰æ‘", subs: [ { name: "Indie Folk", desc: "æ£®æ—ç³»", prompt: "Indie Folk, Bon Iver Style, Cabin Vibe, Acoustic Harmony", code: "IndieFolk" }, { name: "Cinematic Folk", desc: "å²è©©æ„Ÿ", prompt: "Cinematic Folk, Epic, Wide Landscapes, Nordic Vibe", code: "CinematicFolk" }, { name: "Country Pop", desc: "ç¾å¼é„‰æ‘", prompt: "Country Pop, Nashville Sound, Acoustic Guitar, Storytelling", code: "CountryPop" }, { name: "Flamenco", desc: "ç†±æƒ…è¥¿ç­ç‰™", prompt: "Flamenco, Spanish Guitar, Passionate, Hand Claps", code: "Flamenco" } ] },
            "jazz_blues": { name: "ğŸ· çˆµå£«è—èª¿", subs: [ { name: "Bossa Nova", desc: "å·´è¥¿æ…µæ‡¶", prompt: "Bossa Nova, Brazilian Jazz, Relaxing, Soft Guitar", code: "BossaNova" }, { name: "Swing Jazz", desc: "å¤§äº¨å°å‚³", prompt: "Big Band Swing, Gatsby Style, Brass Section, Energetic", code: "Swing" }, { name: "Cool Jazz", desc: "æ·±å¤œé…’å§", prompt: "Cool Jazz, Muted Trumpet, Noir Vibe, Late Night, Smoky", code: "CoolJazz" }, { name: "Chicago Blues", desc: "é›»å‰ä»–è—èª¿", prompt: "Chicago Blues, Electric Guitar, Gritty, Emotional Solo", code: "Blues" } ] },
            "classical_cinematic": { name: "ğŸ» å¤å…¸å²è©©", subs: [ { name: "Epic Orchestral", desc: "æ¼¢æ–¯å­£é»˜é¢¨", prompt: "Epic Orchestral, Hans Zimmer Style, Cinematic, Film Score, Big Percussion", code: "Epic" }, { name: "Minimalism", desc: "æ¥µç°¡é‹¼ç´", prompt: "Minimalism, Philip Glass Style, Repetitive Piano, Emotional", code: "Minimalism" }, { name: "Baroque", desc: "è¯éº—å·´æ´›å…‹", prompt: "Baroque, Harpsichord, Vivaldi Style, Royal, Elegant", code: "Baroque" }, { name: "Fantasy", desc: "å¥‡å¹»é­”æ³•", prompt: "Fantasy Score, Magical, Harry Potter Style, John Williams Style, Wondrous", code: "Fantasy" } ] },
            "latin_world": { name: "ğŸï¸ æ‹‰ä¸ä¸–ç•Œ", subs: [ { name: "Reggaeton", desc: "é›·é¬¼å‹•", prompt: "Reggaeton, Dembow Rhythm, Club Hit, Latin Urban", code: "Reggaeton" }, { name: "Salsa", desc: "å¤å·´ç†±æƒ…", prompt: "Salsa, Cuban Piano, Brass Section, Danceable", code: "Salsa" }, { name: "Bollywood", desc: "å¯¶èŠå¡¢", prompt: "Bollywood, Indian Percussion, Energetic, Sitar, Masala", code: "Bollywood" }, { name: "Celtic", desc: "æ„›çˆ¾è˜­é¢¨", prompt: "Celtic, Irish Folk, Fiddle, Flute, Jig", code: "Celtic" } ] },
            "ambient_lofi": { name: "â˜ï¸ æ°›åœä½å‚³çœŸ", subs: [ { name: "Healing", desc: "ç™‚ç™’SPA", prompt: "Healing Music, Meditation, Spa, Soft Pads, 432Hz", code: "Healing" }, { name: "Dark Ambient", desc: "ææ€–æ‡¸ç–‘", prompt: "Dark Ambient, Horror, Unsettling, Drone, Scary", code: "DarkAmbient" }, { name: "Space Ambient", desc: "å¤ªç©ºæ¼‚æµ®", prompt: "Space Ambient, Sci-Fi, Floating, Zero Gravity, Interstellar", code: "SpaceAmbient" } ] }
        };
        
        // --- ğŸ§  å®Œæ•´ç‰ˆç¥ç¶“ç¶²çµ¡è³‡æ–™åº« ---
        const decisionTree = {
            id: 'root',
            label: 'é–‹å§‹ï¼šå‰µä½œç›®çš„',
            children: [
                {
                    id: 'video',
                    icon: 'ğŸ¬',
                    label: 'å½±ç‰‡é…æ¨‚',
                    desc: 'ç‚ºå½±åƒä½œå“æ³¨å…¥éˆé­‚',
                    children: [
                        {
                            id: 'vlog',
                            icon: 'ğŸ¤³',
                            label: 'ç”Ÿæ´» Vlog / æ—…éŠ',
                            desc: 'æ—¥å¸¸è¨˜éŒ„ã€è¼•å¿«ç¯€å¥',
                            children: [
                                { id: 'vlog_happy', icon: 'ğŸ˜Š', label: 'è¼•é¬†æ„‰å¿«', desc: 'æ—©æ™¨ã€å’–å•¡å»³', auto: { genreKey: 'folk_acoustic', subIndex: 2, mood: 'Major Key, Uplifting', bpm: '120 BPM' } },
                                { id: 'vlog_nostalgic', icon: 'ğŸŒ‡', label: 'æ‡·èˆŠæ„Ÿæ€§', desc: 'å¤•é™½ã€å›æ†¶', auto: { genreKey: 'hiphop_rb', subIndex: 1, mood: 'Nostalgic, Warm', bpm: '90 BPM' } },
                                { id: 'vlog_chic', icon: 'ğŸ•¶ï¸', label: 'æ™‚å°šå¿«ç¯€å¥', desc: 'ç©¿æ­ã€é€›è¡—', auto: { genreKey: 'pop_electronic', subIndex: 2, mood: 'Confident, Stylish', bpm: '124 BPM' } }
                            ]
                        },
                        {
                            id: 'film',
                            icon: 'ğŸ¥',
                            label: 'é›»å½±æ•˜äº‹ / å¾®é›»å½±',
                            desc: 'æƒ…ç·’é‹ªé™³ã€èµ·æ‰¿è½‰åˆ',
                            children: [
                                { id: 'film_epic', icon: 'âš”ï¸', label: 'å²è©©å£¯é—Š', desc: 'å¤§å ´é¢ã€ç®¡å¼¦æ¨‚', auto: { genreKey: 'classical_cinematic', subIndex: 0, mood: 'Epic, Heroic', bpm: '90 BPM' } },
                                { id: 'film_tense', icon: 'ğŸ˜°', label: 'æ‡¸ç–‘ç·Šå¼µ', desc: 'é©šæ‚šã€åµæ¢', auto: { genreKey: 'ambient_lofi', subIndex: 1, mood: 'Suspenseful, Dark', bpm: '70 BPM' } },
                                { id: 'film_emo', icon: 'ğŸ˜­', label: 'æ„Ÿäººå‚¬æ·š', desc: 'åŠ‡æƒ…ç‰‡ã€é‹¼ç´', auto: { genreKey: 'classical_cinematic', subIndex: 1, mood: 'Emotional, Sad', bpm: '65 BPM' } }
                            ]
                        },
                        {
                            id: 'ad',
                            icon: 'ğŸ’¼',
                            label: 'å•†æ¥­å»£å‘Š',
                            desc: 'æ­£å‘ã€å®‰å…¨ã€ä¸æ¶æˆ²',
                            children: [
                                { id: 'ad_corp', icon: 'ğŸ¢', label: 'ç©©é‡å°ˆæ¥­', desc: 'ç§‘æŠ€ã€ä¼æ¥­å½¢è±¡', auto: { genreKey: 'ambient_lofi', subIndex: 2, mood: 'Corporate, Minimal', bpm: '110 BPM' } },
                                { id: 'ad_upbeat', icon: 'âœ¨', label: 'æ´»æ½‘æ­£å‘', desc: 'ä¿ƒéŠ·ã€é£Ÿå“', auto: { genreKey: 'pop_electronic', subIndex: 4, mood: 'Upbeat, Happy', bpm: '120 BPM' } }
                            ]
                        },
                        {
                            id: 'extreme',
                            icon: 'ğŸ›¹',
                            label: 'æ¥µé™é‹å‹•',
                            desc: 'ç¯€å¥æ„Ÿã€é‡æ“Š',
                            children: [
                                { id: 'ex_aggro', icon: 'ğŸ”¥', label: 'ç‚¸è£‚å¤±çœŸ', desc: 'è³½è»Šã€æ ¼é¬¥', auto: { genreKey: 'rock_alt', subIndex: 0, mood: 'Aggressive, High Energy', bpm: '150 BPM' } },
                                { id: 'ex_cyber', icon: 'âš¡ï¸', label: 'ç–¾é€Ÿæœªä¾†', desc: 'è·‘é…·ã€ç„¡äººæ©Ÿ', auto: { genreKey: 'pop_electronic', subIndex: 5, mood: 'Adrenaline, Fast', bpm: '160 BPM' } }
                            ]
                        }
                    ]
                },
                {
                    id: 'game', 
                    icon: 'ğŸ®', 
                    label: 'éŠæˆ²/ç›´æ’­', 
                    desc: 'å¾ªç’°èƒŒæ™¯éŸ³',
                    children: [
                        { id: 'game_battle', icon: 'ğŸ”¥', label: 'æˆ°é¬¥å ´æ™¯', desc: 'é«˜å¼µåŠ›å¾ªç’°', auto: { genreKey: 'rock_alt', subIndex: 4, mood: 'Action, Intense', bpm: '140 BPM' } },
                        { id: 'game_chill', icon: 'â˜ï¸', label: 'è¾²å ´/å¤§å»³', desc: 'æ”¾é¬†æ°›åœ', auto: { genreKey: 'ambient_lofi', subIndex: 0, mood: 'Relaxing, Cute', bpm: '80 BPM' } }
                    ]
                },
                {
                    id: 'listening', 
                    icon: 'ğŸ§', 
                    label: 'ç´”è†è½/ç™¼è¡Œ', 
                    desc: 'å®Œæ•´çµæ§‹æ­Œæ›²', 
                    action: () => alert('ğŸ’¡ æç¤ºï¼šè«‹ç›´æ¥åœ¨ä¸‹æ–¹æ‰‹å‹•é¸æ“‡ Layer 2 (é¢¨æ ¼) é–‹å§‹å‰µä½œæ‚¨çš„å–®æ›²ï¼') 
                }
            ]
        };
        
        // --- ğŸ§ª åŒ–å­¸åæ‡‰é‚è¼¯ (Smart Advisor V24.0) ---
        const genreInteractions = {
            "CityPop": { "Saxophone":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šCity Pop å¿…å‚™éˆé­‚ã€‚"}, "Brass":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šå¢åŠ  80 å¹´ä»£å¥¢è¯æ„Ÿã€‚"}, "Slap Bass":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šå¾‹å‹•æ ¸å¿ƒã€‚"}, "Phonk":{type:"conflict",msg:"âš ï¸ è¡çªï¼šç ´å£å„ªé›…æ„Ÿã€‚"} },
            "Synthwave": { "Synthesizer":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šæ ¸å¿ƒå…ƒç´ ã€‚"}, "Electric Guitar":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šTop Gun ç†±è¡€æ„Ÿã€‚"}, "Acoustic":{type:"conflict",msg:"âš ï¸ è¡çªï¼šæœ¨å‰ä»–å¤ªé•å’Œã€‚"} },
            "Trap": { "Heavy 808":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šå¿ƒè‡Ÿã€‚"}, "Brass":{type:"fusion",msg:"ğŸ§ª èåˆï¼šEpic Trapã€‚"}, "Flute":{type:"fusion",msg:"ğŸ§ª èåˆï¼šTrap Fluteã€‚"}, "Acoustic":{type:"fusion",msg:"ğŸ§ª èåˆï¼šEmo Rapã€‚"} },
            "Lofi": { "Electric Piano":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šRhodes æº«æš–æ„Ÿã€‚"}, "Vinyl":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šå¿…è¦åº•å™ªã€‚"}, "Muted Trumpet":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šæ·±å¤œå­¤ç¨æ„Ÿã€‚"}, "Aggressive":{type:"conflict",msg:"âš ï¸ è¡çªï¼šç ´å£æ”¾é¬†æ„Ÿã€‚"} },
            "Drill": { "Grand Piano":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šé™°æš—æ—‹å¾‹ã€‚"}, "808":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šSliding Bassã€‚"}, "Happy":{type:"conflict",msg:"âš ï¸ è¡çªï¼šDrill ä¸é©åˆå¿«æ¨‚ã€‚"} },
            "PopPunk": { "Electric Guitar":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šPower Chordsã€‚"}, "Live Drum":{type:"classic",msg:"âœ… ç¶“å…¸ã€‚"}, "No Drums":{type:"conflict",msg:"âš ï¸ è¡çªï¼šå¤±å»å‹•åŠ›ã€‚"} },
            "IndieRock": { "Clean":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šæ¸…è„†å‰ä»–ã€‚"}, "Synthesizer":{type:"fusion",msg:"ğŸ§ª èåˆï¼šIndietronicaã€‚"} },
            "IndieFolk": { "Acoustic Guitar":{type:"classic",msg:"âœ… ç¶“å…¸ã€‚"}, "Flute":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šç²¾éˆæ„Ÿã€‚"}, "Harmonica":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šå…¬è·¯æ„Ÿã€‚"}, "Distortion":{type:"conflict",msg:"âš ï¸ è¡çªï¼šç ´å£éŸ³è³ªã€‚"} },
            "CoolJazz": { "Muted Trumpet":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šNoir Vibeã€‚"}, "Saxophone":{type:"classic",msg:"âœ… ç¶“å…¸ã€‚"}, "Synthesizer":{type:"conflict",msg:"âš ï¸ è¡çªï¼šå¤ªé›»å­ã€‚"}, "Autotune":{type:"conflict",msg:"âš ï¸ é¢¨æ ¼åŠ«æŒï¼šAutotune æœƒå°‡çˆµå£«å¼·åˆ¶è½‰ç‚º Trapã€‚å»ºè­°æ”¹é¸ 'Soft Male Vocals'ã€‚"} },
            "Fusion": { "Electric Piano":{type:"classic",msg:"âœ… ç¶“å…¸ã€‚"}, "Slap Bass":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šFunk Jazzã€‚"} },
            
            // --- Epic Case Fix ---
            "Epic": { 
                "Brass":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šè‹±é›„æ„Ÿã€‚"}, 
                "Orchestral Perc":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šæˆ°é¼“ã€‚"}, 
                "Trap":{type:"fusion",msg:"ğŸ§ª èåˆï¼šEpic Hybridã€‚"},
                "Raspy":{type:"conflict",msg:"âš ï¸ é¢¨æ ¼åŠ«æŒï¼š'Raspy' æœƒå°‡å²è©©é…æ¨‚å¼·åˆ¶è½‰ç‚ºæ–æ»¾æ¨‚ã€‚è‹¥æƒ³è¦æ²™å•æ„Ÿï¼Œå»ºè­°æ”¹é¸ 'Powerful'ã€‚"},
                "Dry Sound":{type:"conflict",msg:"âš ï¸ ç©ºé–“æ„Ÿè­¦å‘Šï¼š'Dry Sound' æœƒè®“äº¤éŸ¿æ¨‚è½èµ·ä¾†åƒå°æˆ¿é–“éŒ„éŸ³ã€‚å»ºè­°æ”¹é¸ 'High Fidelity'ã€‚"}
            },
            
            "Salsa": { "Brass":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šéŠ…ç®¡ç‚¸è£‚ã€‚"}, "World Perc":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šåº·åŠ é¼“ã€‚"}, "Straight Rock":{type:"conflict",msg:"âš ï¸ è¡çªï¼šç¯€å¥å¤ªç›´ã€‚"} },
            "Reggaeton": { "Synthesizer":{type:"fusion",msg:"ğŸ§ª èåˆï¼šLatin Popã€‚"}, "Distorted 808":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šDembowã€‚"} },
            "Healing": { "Synthesizer":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šPadsã€‚"}, "Flute":{type:"classic",msg:"âœ… ç¶“å…¸ï¼šNew Ageã€‚"}, "Drum Kit":{type:"conflict",msg:"âš ï¸ è¡çªï¼šå¤ªåµã€‚"} }
        };

        // --- åŠŸèƒ½å‡½å¼ ---

        let navHistory = [];
        function initNeuralNav() { renderNeuralNodes(decisionTree.children); }

        function renderNeuralNodes(nodes) {
            const container = document.getElementById('neuralNodes');
            container.innerHTML = '';
            nodes.forEach(node => {
                const div = document.createElement('div');
                div.className = 'neural-node';
                div.onclick = () => handleNodeClick(node);
                div.innerHTML = `<div class="node-icon">${node.icon || 'ğŸ”¹'}</div><div class="node-label">${node.label}</div>`;
                if(node.desc) div.innerHTML += `<div class="node-desc">${node.desc}</div>`; // Add desc back
                container.appendChild(div);
            });
            updateBreadcrumbs();
        }

        function handleNodeClick(node) {
            if(node.action) { node.action(); return; } // Handle leaf actions
            navHistory.push(node);
            if (node.children) renderNeuralNodes(node.children);
            else if (node.auto) { renderFinalStep(node); applyAutoSettings(node.auto); }
        }

        function renderFinalStep(node) {
             const container = document.getElementById('neuralNodes');
             container.innerHTML = `<div class="neural-node" style="border-color:#55efc4; width:100%;"><div class="node-icon">âœ…</div><div class="node-label">é…ç½®å®Œæˆï¼š${node.label}</div><button onclick="resetNeuralNav()" style="margin-top:5px;background:#636e72;color:white;border:none;">ğŸ”„ é‡æ–°å°èˆª</button></div>`;
             updateBreadcrumbs();
             document.getElementById('neuralStatus').style.display = 'block';
        }

        function applyAutoSettings(auto) {
            resetAll();
            const genreBtn = document.querySelector(`.btn-main-genre[onclick*="${auto.genreKey}"]`);
            if (genreBtn) {
                renderSubGenres(auto.genreKey, genreBtn);
                setTimeout(() => {
                    const subData = genreData[auto.genreKey].subs[auto.subIndex];
                    selectSubGenre(subData, document.querySelectorAll('.sub-btn')[auto.subIndex]);
                }, 50);
            }
            tags.push(auto.mood);
            bpmTag = auto.bpm;
            render();
        }

        function updateBreadcrumbs() {
            const bc = document.getElementById('neuralBreadcrumbs');
            let html = `<span class="crumb" onclick="resetNeuralNav()">èµ·é»</span>`;
            navHistory.forEach(n => html += ` > <span class="crumb">${n.label}</span>`);
            bc.innerHTML = html;
        }
        function resetNeuralNav() { navHistory = []; renderNeuralNodes(decisionTree.children); document.getElementById('neuralStatus').style.display = 'none'; resetAll(); }
        window.onload = initNeuralNav;

        // --- Monitor System (V23) ---
        function toggleMonitorMode() {
            monitorMode = monitorMode === 'focus' ? 'radar' : 'focus';
            document.getElementById('focusMode').style.display = monitorMode === 'focus' ? 'block' : 'none';
            document.getElementById('radarMode').style.display = monitorMode === 'radar' ? 'flex' : 'none';
        }

        function updateMonitor() {
            // 1. Calculate Precision Score
            let score = 0;
            if (currentSubGenreCode) score += 30; // é¢¨æ ¼æ¬Šé‡æœ€å¤§
            if (tags.some(t => document.querySelector(`.btn-emo[data-val="${t}"]`))) score += 15; // æƒ…æ„Ÿ
            if (bpmTag) score += 10;
            if (lengthTag) score += 5;
            if (tags.some(t => document.querySelector(`.btn-inst[data-val="${t}"]`))) score += 20; // æ¨‚å™¨
            if (tags.some(t => document.querySelector(`.btn-vox[data-val="${t}"]`))) score += 10; // äººè²
            if (tags.some(t => document.querySelector(`.btn-mix[data-val="${t}"]`))) score += 10; // æ··éŸ³

            score = Math.min(100, score);
            
            // Update UI
            document.getElementById('focusBar').style.width = score + '%';
            document.getElementById('focusPercent').innerText = score + '%';
            let label = "ğŸ² AI éš¨æ©Ÿç”Ÿæˆ";
            if(score > 30) label = "ğŸ¨ å…±åŒå‰µä½œå€";
            if(score > 70) label = "ğŸ¯ ç²¾æº–æ§åˆ¶å€";
            document.getElementById('focusLabel').innerText = label;

            // Ghost Chips
            const chips = [];
            if(!currentSubGenreCode) chips.push({label:'â“é¢¨æ ¼', id:'layer-style'});
            if(!tags.some(t => document.querySelector(`.btn-emo[data-val="${t}"]`))) chips.push({label:'â“æƒ…æ„Ÿ', id:'layer-mood'});
            if(!bpmTag) chips.push({label:'â“é€Ÿåº¦', id:'layer-bpm'});
            if(!tags.some(t => document.querySelector(`.btn-vox[data-val="${t}"]`))) chips.push({label:'â“äººè²', id:'layer-vox'});
            
            const chipsContainer = document.getElementById('ghostChips');
            chipsContainer.innerHTML = '';
            chips.forEach(c => {
                const span = document.createElement('span');
                span.className = 'ghost-chip';
                span.innerText = c.label;
                span.onclick = () => document.getElementById(c.id).scrollIntoView({behavior:'smooth'});
                chipsContainer.appendChild(span);
            });

            // 2. Update Radar Chart
            updateRadar(score);
        }

        function updateRadar(totalScore) {
            // ç°¡åŒ–ç‰ˆï¼šæ ¹æ“šå„å€‹å‘åº¦çš„å®Œæˆç‹€æ³å¡«æ»¿
            // è»¸åºï¼šStyle(Top), Mood, Rhythm, Mix, Vox, Inst
            const cx = 50, cy = 50;
            // é€™è£¡ç°¡å–®æ¨¡æ“¬æ¯å€‹è»¸çš„å€¼ (0~1)
            let vStyle = currentSubGenreCode ? 0.9 : 0.2;
            let vMood = tags.some(t => document.querySelector(`.btn-emo[data-val="${t}"]`)) ? 0.8 : 0.2;
            let vRhythm = bpmTag ? 0.8 : 0.2;
            let vMix = tags.some(t => document.querySelector(`.btn-mix[data-val="${t}"]`)) ? 0.8 : 0.2;
            let vVox = tags.some(t => document.querySelector(`.btn-vox[data-val="${t}"]`)) ? 0.8 : 0.2;
            let vInst = tags.some(t => document.querySelector(`.btn-inst[data-val="${t}"]`)) ? 0.8 : 0.2;

            // è¨ˆç®—åæ¨™é» (åŠå¾‘æœ€å¤§35)
            const r = 35;
            const p1 = [cx, cy - r * vStyle]; // Top
            const p2 = [cx + r * 0.866 * vMood, cy - r * 0.5 * vMood];
            const p3 = [cx + r * 0.866 * vRhythm, cy + r * 0.5 * vRhythm];
            const p4 = [cx, cy + r * vMix]; // Bottom
            const p5 = [cx - r * 0.866 * vVox, cy + r * 0.5 * vVox];
            const p6 = [cx - r * 0.866 * vInst, cy - r * 0.5 * vInst];

            const poly = document.getElementById('radarShape');
            poly.setAttribute('points', `${p1.join(',')} ${p2.join(',')} ${p3.join(',')} ${p4.join(',')} ${p5.join(',')} ${p6.join(',')}`);
        }

        // --- åŸºç¤é‚è¼¯ ---

        function selectSingle(el, type) {
            const val = el.getAttribute('data-val');
            let groupClass = type === 'struct' ? '.btn-struct' : (type === 'length' ? '.btn-length' : '.btn-bpm');
            document.querySelectorAll(groupClass).forEach(b => b.classList.remove('active'));
            if(type === 'struct') { if(struct===val) struct=""; else {struct=val; el.classList.add('active');} }
            if(type === 'length') { if(lengthTag===val) lengthTag=""; else {lengthTag=val; el.classList.add('active');} }
            if(type === 'bpm') { if(bpmTag===val) bpmTag=""; else {bpmTag=val; el.classList.add('active');} }
            updateChemistry(); render();
        }

        function toggleTag(el) {
            const val = el.getAttribute('data-val');
            if (tags.includes(val)) { tags = tags.filter(t => t !== val); el.classList.remove('active'); } 
            else { tags.push(val); el.classList.add('active'); }
            updateChemistry(); render();
        }

        function renderSubGenres(key, btnEl) {
            document.querySelectorAll('.btn-main-genre').forEach(b => b.classList.remove('active'));
            btnEl.classList.add('active');
            const data = genreData[key];
            const container = document.getElementById('subGenreDisplay');
            container.style.display = 'grid'; container.innerHTML = '';
            data.subs.forEach((sub, idx) => {
                const btn = document.createElement('button');
                btn.className = 'sub-btn';
                btn.onclick = () => selectSubGenre(sub, btn);
                btn.innerHTML = `<span class="sub-name">${sub.name}</span><span class="sub-desc">${sub.desc}</span>`;
                container.appendChild(btn);
            });
        }

        function selectSubGenre(sub, btnEl) {
            if (currentSubGenrePrompt) tags = tags.filter(t => t !== currentSubGenrePrompt);
            currentSubGenrePrompt = sub.prompt; currentSubGenreCode = sub.code; tags.push(sub.prompt);
            document.querySelectorAll('.sub-btn').forEach(b => b.classList.remove('active'));
            btnEl.classList.add('active');
            updateChemistry(); render();
        }

        function updateChemistry() {
            const lab = document.getElementById('chemistryContent');
            const activeTags = [...tags]; if(lengthTag) activeTags.push(lengthTag); if(bpmTag) activeTags.push(bpmTag);
            if (!currentSubGenreCode) { lab.innerHTML = "è«‹å…ˆé¸æ“‡ <b>Layer 3</b> çš„ä¸€ç¨®å­é¢¨æ ¼..."; return; }
            const rules = genreInteractions[currentSubGenreCode];
            let html = "";
            activeTags.forEach(tag => {
                if(rules) {
                    for (const [key, val] of Object.entries(rules)) {
                        if (tag.includes(key)) html += `<div class="reaction-item reaction-${val.type}">${val.msg}</div>`;
                    }
                }
            });
            lab.innerHTML = html || `ç›®å‰é¸æ“‡çš„å…ƒç´ èˆ‡ <b>${currentSubGenreCode}</b> æš«ç„¡ç‰¹æ®Šåæ‡‰ã€‚`;
            updateMonitor(); // é€£å‹•æ›´æ–° Monitor
        }

        function resetAll() {
            struct = ""; tags = []; lengthTag = ""; bpmTag = ""; currentSubGenreCode = ""; currentSubGenrePrompt = "";
            document.getElementById('customInput').value = "";
            document.getElementById('userEmail').value = ""; // Clear email
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            document.getElementById('subGenreDisplay').style.display = 'none';
            document.getElementById('chemistryContent').innerHTML = "è«‹å…ˆé¸æ“‡ <b>Layer 3</b> é¢¨æ ¼...";
            render();
            updateMonitor();
        }

        function render() {
            let res = "";
            let customText = document.getElementById('customInput').value.trim();
            if (struct) res += struct + "\n";
            let allTags = [...tags]; if (lengthTag) allTags.push(lengthTag); if (bpmTag) allTags.push(bpmTag); if (customText) allTags.push(customText);
            if (allTags.length > 0) res += allTags.join(", ");
            document.getElementById('output').value = res;
            document.getElementById('charCount').innerText = res.length + " / 500";
            updateMonitor();
        }

        function copyText() {
            let box = document.getElementById('output');
            if(!box.value) return alert("è«‹å…ˆé¸æ“‡ï¼");
            box.select(); navigator.clipboard.writeText(box.value);
            let btn = document.querySelector('.copy-btn'); let orig = btn.innerText; btn.innerText = "âœ… è¤‡è£½æˆåŠŸï¼";
            setTimeout(() => btn.innerText = orig, 2000);
        }
        
        function sendToDev() {
            let prompt = document.getElementById('output').value;
            if(!prompt) return alert("è«‹å…ˆç”ŸæˆæŒ‡ä»¤å†å‚³é€ï¼");
            
            let userEmail = document.getElementById('userEmail').value || "Anonymous";
            let subject = encodeURIComponent("ğŸ» superL AI éŸ³æ¨‚æŒ‡ä»¤å›é¥‹");
            let body = encodeURIComponent(`Hi superL Team,\n\né€™æ˜¯æˆ‘å‰›å‰›ç”Ÿæˆçš„æŒ‡ä»¤ï¼Œåˆ†äº«çµ¦æ‚¨åƒè€ƒï¼š\n\nã€æˆ‘çš„ Emailã€‘: ${userEmail}\n\nã€ç”ŸæˆæŒ‡ä»¤ã€‘:\n${prompt}\n\n(æ­¤éƒµä»¶ç”±ç³»çµ±è‡ªå‹•ç”Ÿæˆ)`);
            
            window.location.href = `mailto:willis3201@gmail.com?subject=${subject}&body=${body}`;
        }
        
        function applyPreset(name) {
             // ç°¡åŒ–ç‰ˆ presetï¼Œåªåšç¤ºç¯„
             resetAll();
             tags.push(name === 'cyberpunk' ? 'Cyberpunk, Synthwave' : 'Pop');
             render();
        }
    </script>
</body>
</html>